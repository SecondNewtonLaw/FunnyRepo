<!DOCTYPE html>
<html>
  <head>
    <script
      defer
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6547428867970188"
      crossorigin="anonymous"
    ></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6547428867970188"
         crossorigin="anonymous"></script>
    <script src="./external/three.r134.min.js"></script>
    <script async src="./external/vanta.dots.min.js"></script>
    <script defer src="./js/audioPlayer.js"></script>
    <script defer>
      // Audio Instance.
      let audioLnk = "./audio/party.mp3";
      let videoLnk = "./video/skull_rotate.mp4";
      let videoInstance = undefined;
      let audioInstance = undefined;
        function rewindToDefault() {
            audioLnk = "./audio/party.mp3";
            videoLnk = "./video/skull_rotate.mp4";
            audioInstance.src = audioLnk;
            videoInstance.src = videoLnk
            let btn = document.getElementById("rewindBtn");
            btn.hidden = true;
        }
        function defineVideo() {
            videoInstance = document.getElementById("VIDEO_SKULL_ROT");
            videoInstance.volume = 0;
            videoInstance.loop = true;
        }
        function playOrPauseAudio() {
            if (audioInstance === undefined)
                audioInstance = playAudio(audioLnk);
    
            if (videoInstance === undefined)
                defineVideo();            
            if (audioInstance.paused) {
                audioInstance.play();
                videoInstance.play();
            } else {
                audioInstance.pause();
                videoInstance.pause();
            }
        }

      // Dynamically sets the old CSS background.
      function __setBg() {
        const htmlBody = document.getElementsByTagName("body")[0];

        console.log("Loading CSS...");
        loadCssIntoDom("./css/oldBackground.css"); // from helpers.js

        for (let i = 1; i < 4; i++) {
          // Creating element
          console.log("Inserting background parts... [" + i + "/3]");
          const newElement = document.createElement("div");
          newElement.classList.add("bg");
          if (i > 1) {
            newElement.classList.add("bg" + i);
          }
          htmlBody.append(newElement);
        }
        console.log("Removing stub background element...");
        document.getElementById("background").id = ""; // remove old background stub id.
      }
      function setBg() {
        //injectMobilePredicate(); // from detectMobile.js

        //let isMobile = window.isMobile(); // Verify platform.

        console.log("Applying Background...");
        //console.log("Old Background Applied.");
        __setBg();
        /*
          VANTA.DOTS({
            el: "#background",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: window.innerHeight - 40,
            minWidth: window.innerWidth - 100,
            scale: 1.0,
            scaleMobile: 1.0,
            color: 0xffffff,
            color2: 0xf2f2f2,
            backgroundColor: 0x0,
            spacing: 27.0,
            showLines: false,
          });
        */
      }
      const code = "03/19";
      function requestCode(){
          let response = window.prompt("What is the \"secret\" code?!", "Ignore if you don't know!");
          
          if (response && response !== ""){
              if (response === code) {
                  audioInstance = playAudio(audioLnk); // Define Audio.
                  defineVideo(); // Define video, we need to modify it rn!
                  console.log("Correct! Proceeding with changes.");
                  audioLnk = "./audio/happyBirthday.mp3";
                  videoLnk = "./video/robuxFreeVideo.mp4";
                  document.querySelector('title').text = "Happy Birthday s0me1!";
                  videoInstance.src = videoLnk;
                  audioInstance.src = audioLnk;
                  let btn = document.getElementById("rewindBtn");
                  btn.hidden = false;
                  return undefined;
              }
              videoInstance.src = videoLnk;
          }
          
      }
      function startActivity() {
        requestCode();
        console.log("Starting Audio Playback...");
        audioInstance = playAudio(audioLnk);
        audioInstance.pause();
        console.log("Audio Playback started.");
        // ----
        console.log("Starting Page Background...");
        // setBg();
        console.log("Page Background started.");
      }
    </script>
    <title>Party Momento</title>
    <meta charset="UTF-8" />
    <meta content="Embed Title" property="og:title" />
    <meta content="Site Description" property="og:description" />
    <meta content="https://embed.com/this-is-the-site-url" property="og:url" />
    <meta content="https://embed.com/embedimage.png" property="og:image" />
    <meta content="#43B581" data-react-helmet="true" name="theme-color" />
    <meta name="description" content="Totally not intended for s0me1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="./images/blob_dance.gif" type="image/gif" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap");

      h1 {
        text-align: center;
        padding-top: 25%;
      }

      h2 {
        text-align: center;
        text-rendering: optimizeLegibility;
        color: white;
        font-size: 6vw;
        font-family: "Source Sans Pro", "Gill Sans MT", Calibri, "Trebuchet MS",
          sans-serif;
      }
    </style>
  </head>

  <body onload="startActivity()" style="background-color: #000000">
    <div style="z-index: -1; background-color: rgb(0, 0, 0)"></div>
    <!--div style="flex: content; padding: 4vw">
      <h2>Don't let the party die!</h2>
    </div-->
    <button id="rewindBtn" onclick="rewindToDefault()"
            style="
            width: 380px;
            height: 150px;
            position: absolute;
            left: 50%;
            transform: translate(-65%, -0%);
            background-color: rgb(2, 2, 2);
            color: rgb(179, 0, 0);
            font-size: 80px;
margin-bottom: 500px" hidden = "hidden">
        rewind
        
    </button>
    <div
      style="
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      "
    >
      <!--img
        alt="party-emoji"
        src="/images/blob_dance.gif"
        width="200"
        height="200"
      /-->
        <video id="VIDEO_SKULL_ROT" src="./video/skull_rotate.mp4" style="
            left:20%">
        </video>
        
        
        <button onclick="playOrPauseAudio()" style="
                width: 380px;
                height: 150px;
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-65%, -50%);
                background-color: rgb(2, 2, 2);
                color: rgb(0, 0, 102);
                font-size: 80px;
margin-top: 325px">
            spin.
        </button>
        
    </div>
  </body>
</html>
